# 데이콘 Basic 스트레스 지수 예측 : 건강 데이터로 마음의 균형을 찾아라!

### **2025-07-01 ~ 2025.08.29**
### [Competition Link](https://dacon.io/competitions/open/236526/overview/description)
- 이번 해커톤에서는 신체 정보, 수면 패턴 및 활동량 등 다양한 건강 데이터를 활용하여 
개인의 스트레스 점수를 예측하는 AI 알고리즘 개발

- 평가 산식: MAE  

- 20th out of 382 teams (top 3%) 

- 주최: 데이콘
---
### **개발 환경**

- **운영체제**: macos 26.0
- **언어**: Python 3.11

---

### **주요 특징**

- **피처 엔지니어링**: BMI, 혈압 파생변수(맥압, 평균동맥압), 포도당-콜레스테롤 비율 등 의료 도메인 지식을 활용한 파생 변수 생성으로 스트레스에 영향을 미치는 핵심 지표를 수치화했습니다.
- **결측값 처리**: 범주형 데이터는 'Null'로 임시 처리 후 문맥적 의미를 가진 값('만성질환 없음', '없음')으로 대치하여 도메인 특성을 반영했습니다.
- **CatBoost**: 범주형 변수를 자연스럽게 처리할 수 있는 CatBoost 알고리즘을 사용하여 복잡한 인코딩 과정 없이도 높은 성능을 달성했습니다.
- **타겟 스케일링**: StandardScaler를 통한 타겟 변수 정규화로 모델 학습 안정성을 확보했습니다.
- **하이퍼파라미터 최적화**: Optuna를 통해 도출된 최적 파라미터로 CatBoost 모델을 구성했습니다.
- **전처리 파이프라인**: OneHotEncoder와 StandardScaler를 결합한 체계적인 전처리 파이프라인으로 수치형과 범주형 데이터를 통합 처리했습니다.

---



### **프로젝트 구조**

```
Dacon_Basic_Stress_Index_Prediction/
├── data/                   # 데이터 폴더
│   ├── train.csv          # 학습 데이터
│   ├── test.csv           # 테스트 데이터
│   └── sample_submission.csv  # 제출 파일 템플릿
├── 0.15444.ipynb          # 메인 모델링 노트북
├── result_catboost_single.csv  # CatBoost 모델 예측 결과
├── README.md              # 프로젝트 설명서
├── requirements.txt       # 의존성 패키지 목록
└── .gitignore            # Git 무시 파일 목록
```

---

### **모델링 접근법**

개인의 신체적, 생활습관, 의료기록 등 다양한 데이터를 활용하여 스트레스 지수를 예측하는 회귀 모델을 구축했습니다. CatBoost 단일 모델을 통해 간결하면서도 정확한 예측을 달성했습니다.

***

### 1. 데이터 전처리 파이프라인
- **결측값 처리**: 범주형 변수는 임시 'Null' 처리 후 의미있는 값으로 대치 ('만성질환 없음', '없음')
- **ID 컬럼 제거**: 불필요한 식별자 컬럼 제거로 모델 학습 최적화
- **데이터 타입별 분리**: 수치형과 범주형 변수를 자동으로 분리하여 적절한 전처리 적용
- **스케일링**: 수치형 변수는 StandardScaler, 범주형 변수는 OneHotEncoder 적용

### 2. 파생변수 생성 (의료 도메인 기반)
- **BMI 계산**: 신장과 체중을 이용한 체질량지수 산출
- **혈압 파생 변수**: 
  - 맥압 (pulse_pressure): 수축기압 - 이완기압
  - 평균동맥압 (map_pressure): 이완기압 + (맥압 / 3)
- **대사 지표**: 포도당/콜레스테롤 비율로 대사 건강 상태 평가
- **상호작용 변수**: 
  - 신장 × 체중 상호작용
  - 나이 × 활동 수준 상호작용 (활동 수준을 수치화하여 계산)

### 3. CatBoost 모델링 전략
- **CatBoost Regressor**: 범주형 데이터 처리에 특화된 그래디언트 부스팅 알고리즘
- **최적 하이퍼파라미터**: 베이지안 최적화를 통해 도출된 파라미터 적용
  - iterations: 2400
  - depth: 10
  - learning_rate: 0.0298
  - l2_leaf_reg: 1.854
  - bagging_temperature: 1.929
  - random_strength: 0.796
- **타겟 정규화**: StandardScaler를 통한 스트레스 점수 정규화 후 역변환으로 최종 예측값 생성

### 4. 모델 성능 및 후처리
- **예측값 후처리**: 0-1 범위로 클리핑 및 소수점 둘째 자리까지 반올림
- **단일 모델 접근**: 복잡한 앙상블 대신 최적화된 단일 CatBoost 모델로 효율성과 성능 균형 달성
- **재현 가능성**: random_seed 고정으로 결과 재현성 보장

---

### **파일 설명**

#### `0.15444.ipynb`
- **데이터 로딩**: train.csv, test.csv, sample_submission.csv 불러오기
- **피처 엔지니어링 함수 정의**:
  - BMI 계산: 체중 / (신장/100)²
  - 혈압 파생변수: 맥압, 평균동맥압 계산
  - 포도당/콜레스테롤 비율 계산
  - 상호작용 변수: 신장×체중, 나이×활동수준
- **결측값 처리**:
  - 범주형: 'Null' → '만성질환 없음', '없음' 등으로 의미있는 대치
  - 수치형: median 전략 적용
- **전처리 파이프라인**: 
  - 수치형: SimpleImputer(median) → StandardScaler
  - 범주형: SimpleImputer(most_frequent) → OneHotEncoder
- **CatBoost 모델 학습**:
  - 최적화된 하이퍼파라미터로 모델 훈련
  - 타겟 변수 정규화 후 학습, 예측 시 역변환
- **예측 및 저장**: `result_catboost_single.csv` 생성

#### 데이터 파일
- `train.csv`: 스트레스 학습 데이터 (성별, 나이, 신체정보, 생활습관, 의료기록, 스트레스 점수 등)
- `test.csv`: 스트레스 테스트 데이터 (스트레스 점수 제외)
- `sample_submission.csv`: 제출 파일 템플릿 (ID, 스트레스 점수)

#### `result_catboost_single.csv`
- CatBoost 단일 모델의 최종 스트레스 지수 예측 결과 파일
- 0-1 범위로 정규화되고 소수점 둘째 자리까지 반올림된 예측값


